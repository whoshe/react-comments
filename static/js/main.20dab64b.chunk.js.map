{"version":3,"sources":["comments/CommentForm.js","comments/Comment.js","api.js","comments/Comments.js","App.js","index.js"],"names":["CommentForm","_ref","handleSubmit","submitLabel","_ref$hasCancelButton","hasCancelButton","handleCancel","_ref$initialText","initialText","_useState","useState","_useState2","_slicedToArray","text","setText","isTextareaDisabled","length","_jsxs","onSubmit","event","preventDefault","children","_jsx","className","value","onChange","e","target","disabled","type","onClick","Comment","comment","replies","setActiveComment","activeComment","updateComment","deleteComment","addComment","_ref$parentId","parentId","currentUserId","isEditing","id","isReplying","timePassed","Date","createdAt","canDelete","userId","canReply","Boolean","canEdit","replyId","toLocaleDateString","src","alt","username","body","map","reply","getComments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","abrupt","stop","apply","arguments","createComment","_ref2","_callee2","_args2","_context2","undefined","Math","random","toString","substr","toISOString","_x","_ref3","_callee3","_context3","_x2","_ref4","_callee4","_context4","Comments","commentsUrl","backendComments","setBackendComments","_useState3","_useState4","rootComments","filter","backendComment","createCommentApi","then","concat","_toConsumableArray","commentId","updateCommentApi","updatedBackendComments","_objectSpread","window","confirm","deleteCommentApi","useEffect","getCommentsApi","data","rootComment","sort","a","b","getTime","App","ReactDOM","render","React","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.20dab64b.chunk.js","sourcesContent":["import { useState } from \"react\";\n\nconst CommentForm = ({\n  handleSubmit,\n  submitLabel,\n  hasCancelButton = false,\n  handleCancel,\n  initialText = \"\",\n}) => {\n  const [text, setText] = useState(initialText);\n  const isTextareaDisabled = text.length === 0;\n  const onSubmit = (event) => {\n    event.preventDefault();\n    handleSubmit(text);\n    setText(\"\");\n  };\n  return (\n    <form onSubmit={onSubmit}>\n      <textarea\n        className=\"comment-form-textarea\"\n        value={text}\n        onChange={(e) => setText(e.target.value)}\n      />\n      <button className=\"comment-form-button\" disabled={isTextareaDisabled}>\n        {submitLabel}\n      </button>\n      {hasCancelButton && (\n        <button\n          type=\"button\"\n          className=\"comment-form-button comment-form-cancel-button\"\n          onClick={handleCancel}\n        >\n          Cancel\n        </button>\n      )}\n    </form>\n  );\n};\n\nexport default CommentForm;\n","import CommentForm from \"./CommentForm\";\n\nconst Comment = ({\n  comment,\n  replies,\n  setActiveComment,\n  activeComment,\n  updateComment,\n  deleteComment,\n  addComment,\n  parentId = null,\n  currentUserId,\n}) => {\n  const isEditing =\n    activeComment &&\n    activeComment.id === comment.id &&\n    activeComment.type === \"editing\";\n  const isReplying =\n    activeComment &&\n    activeComment.id === comment.id &&\n    activeComment.type === \"replying\";\n  const fiveMinutes = 300000;\n  const timePassed = new Date() - new Date(comment.createdAt) > fiveMinutes;\n  const canDelete =\n    currentUserId === comment.userId && replies.length === 0 && !timePassed;\n  const canReply = Boolean(currentUserId);\n  const canEdit = currentUserId === comment.userId && !timePassed;\n  const replyId = parentId ? parentId : comment.id;\n  const createdAt = new Date(comment.createdAt).toLocaleDateString();\n  return (\n    <div key={comment.id} className=\"comment\">\n      <div className=\"comment-image-container\">\n        <img src=\"./user-icon.png\" alt='user'/>\n      </div>\n      <div className=\"comment-right-part\">\n        <div className=\"comment-content\">\n          <div className=\"comment-author\">{comment.username}</div>\n          <div>{createdAt}</div>\n        </div>\n        {!isEditing && <div className=\"comment-text\">{comment.body}</div>}\n        {isEditing && (\n          <CommentForm\n            submitLabel=\"Update\"\n            hasCancelButton\n            initialText={comment.body}\n            handleSubmit={(text) => updateComment(text, comment.id)}\n            handleCancel={() => {\n              setActiveComment(null);\n            }}\n          />\n        )}\n        <div className=\"comment-actions\">\n          {canReply && (\n            <div\n              className=\"comment-action\"\n              onClick={() =>\n                setActiveComment({ id: comment.id, type: \"replying\" })\n              }\n            >\n              Reply\n            </div>\n          )}\n          {canEdit && (\n            <div\n              className=\"comment-action\"\n              onClick={() =>\n                setActiveComment({ id: comment.id, type: \"editing\" })\n              }\n            >\n              Edit\n            </div>\n          )}\n          {canDelete && (\n            <div\n              className=\"comment-action\"\n              onClick={() => deleteComment(comment.id)}\n            >\n              Delete\n            </div>\n          )}\n        </div>\n        {isReplying && (\n          <CommentForm\n            submitLabel=\"Reply\"\n            handleSubmit={(text) => addComment(text, replyId)}\n          />\n        )}\n        {replies.length > 0 && (\n          <div className=\"replies\">\n            {replies.map((reply) => (\n              <Comment\n                comment={reply}\n                key={reply.id}\n                setActiveComment={setActiveComment}\n                activeComment={activeComment}\n                updateComment={updateComment}\n                deleteComment={deleteComment}\n                addComment={addComment}\n                parentId={comment.id}\n                replies={[]}\n                currentUserId={currentUserId}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Comment;\n","export const getComments = async () => {\n  return [\n    {\n      id: \"1\",\n      body: \"First comment\",\n      username: \"Jack\",\n      userId: \"1\",\n      parentId: null,\n      createdAt: \"2021-08-16T23:00:33.010+02:00\",\n    },\n    {\n      id: \"2\",\n      body: \"Second comment\",\n      username: \"John\",\n      userId: \"2\",\n      parentId: null,\n      createdAt: \"2021-08-16T23:00:33.010+02:00\",\n    },\n    {\n      id: \"3\",\n      body: \"First comment first child\",\n      username: \"John\",\n      userId: \"2\",\n      parentId: \"1\",\n      createdAt: \"2021-08-16T23:00:33.010+02:00\",\n    },\n    {\n      id: \"4\",\n      body: \"Second comment second child\",\n      username: \"John\",\n      userId: \"2\",\n      parentId: \"2\",\n      createdAt: \"2021-08-16T23:00:33.010+02:00\",\n    },\n  ];\n};\n\nexport const createComment = async (text, parentId = null) => {\n  return {\n    id: Math.random().toString(36).substr(2, 9),\n    body: text,\n    parentId,\n    userId: \"1\",\n    username: \"John\",\n    createdAt: new Date().toISOString(),\n  };\n};\n\nexport const updateComment = async (text) => {\n  return { text };\n};\n\nexport const deleteComment = async () => {\n  return {};\n};\n","import { useState, useEffect } from \"react\";\nimport CommentForm from \"./CommentForm\";\nimport Comment from \"./Comment\";\nimport {\n  getComments as getCommentsApi,\n  createComment as createCommentApi,\n  updateComment as updateCommentApi,\n  deleteComment as deleteCommentApi,\n} from \"../api\";\n\nconst Comments = ({ commentsUrl, currentUserId }) => {\n  const [backendComments, setBackendComments] = useState([]);\n  const [activeComment, setActiveComment] = useState(null);\n  const rootComments = backendComments.filter(\n    (backendComment) => backendComment.parentId === null\n  );\n  const getReplies = (commentId) =>\n    backendComments\n      .filter((backendComment) => backendComment.parentId === commentId)\n      .sort(\n        (a, b) =>\n          new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime()\n      );\n  const addComment = (text, parentId) => {\n    createCommentApi(text, parentId).then((comment) => {\n      setBackendComments([comment, ...backendComments]);\n      setActiveComment(null);\n    });\n  };\n\n  const updateComment = (text, commentId) => {\n    updateCommentApi(text).then(() => {\n      const updatedBackendComments = backendComments.map((backendComment) => {\n        if (backendComment.id === commentId) {\n          return { ...backendComment, body: text };\n        }\n        return backendComment;\n      });\n      setBackendComments(updatedBackendComments);\n      setActiveComment(null);\n    });\n  };\n  const deleteComment = (commentId) => {\n    if (window.confirm(\"Are you sure you want to remove comment?\")) {\n      deleteCommentApi().then(() => {\n        const updatedBackendComments = backendComments.filter(\n          (backendComment) => backendComment.id !== commentId\n        );\n        setBackendComments(updatedBackendComments);\n      });\n    }\n  };\n\n  useEffect(() => {\n    getCommentsApi().then((data) => {\n      setBackendComments(data);\n    });\n  }, []);\n\n  return (\n    <div className=\"comments\">\n      <h3 className=\"comments-title\">Comments</h3>\n      <div className=\"comment-form-title\">Write comment</div>\n      <CommentForm submitLabel=\"Write\" handleSubmit={addComment} />\n      <div className=\"comments-container\">\n        {rootComments.map((rootComment) => (\n          <Comment\n            key={rootComment.id}\n            comment={rootComment}\n            replies={getReplies(rootComment.id)}\n            activeComment={activeComment}\n            setActiveComment={setActiveComment}\n            addComment={addComment}\n            deleteComment={deleteComment}\n            updateComment={updateComment}\n            currentUserId={currentUserId}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default Comments;\n","import Comments from \"./comments/Comments\";\n\nconst App = () => {\n  return (\n    <div>\n      <h1>Hello monsterlessons</h1>\n      <Comments\n        commentsUrl=\"http://localhost:3004/comments\"\n        currentUserId=\"1\"\n      />\n    </div>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}